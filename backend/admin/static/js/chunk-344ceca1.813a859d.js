(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-344ceca1"],{7512:function(e,t,s){"use strict";s("a032")},a032:function(e,t,s){},b85c:function(e,t,s){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=new Array(t);s<t;s++)r[s]=e[s];return r}function n(e,t){if(e){if("string"===typeof e)return r(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?r(e,t):void 0}}function i(e,t){var s="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!s){if(Array.isArray(e)||(s=n(e))||t&&e&&"number"===typeof e.length){s&&(e=s);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){s=s.call(e)},n:function(){var e=s.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==s["return"]||s["return"]()}finally{if(l)throw o}}}}s.d(t,"a",(function(){return i}))},ce1c:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container"},[s("el-form",{ref:"userGroupDetail",attrs:{model:e.userGroupDetail,rules:e.checkRules,"label-width":"120px"}},[s("el-form-item",{attrs:{label:"用户组名称",prop:"name"}},[s("el-input",{attrs:{placeholder:"请输入用户组名称"},model:{value:e.userGroupDetail.name,callback:function(t){e.$set(e.userGroupDetail,"name",t)},expression:"userGroupDetail.name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"用户组的用户列表"}},[s("div",{staticClass:"operation-button"},[s("el-button",{attrs:{type:"primary"},on:{click:e.openAddFromUserListDialog}},[s("i",{staticClass:"el-icon-plus"}),e._v(" 添加用户\n        ")]),e._v(" "),e.userCollectionUserListSelection&&e.userCollectionUserListSelection.length>0?s("el-button",{attrs:{type:"danger"},on:{click:e.onDeleteUserCollectionSelection}},[s("i",{staticClass:"el-icon-delete"}),e._v(" 移除所选的"+e._s(e.userCollectionUserListSelection?e.userCollectionUserListSelection.length+"个":"")+"用户\n        ")]):e._e()],1),e._v(" "),s("el-table",{ref:"userCollectionUserListTable",staticStyle:{width:"100%"},attrs:{data:e.userCollectionUserListTableData,"tooltip-effect":"dark"},on:{select:e.onUserCollectionUserListSelect,"select-all":e.onUserCollectionUserListSelectAll}},[s("el-table-column",{attrs:{type:"selection",align:"center",width:"50"}}),e._v(" "),s("el-table-column",{attrs:{prop:"id",label:"用户ID",align:"center",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"username",label:"用户名",align:"center","min-width":"3","show-overflow-tooltip":!0}}),e._v(" "),s("el-table-column",{attrs:{prop:"studentNo",label:"学号","min-width":"3",align:"center"}})],1),e._v(" "),s("div",{staticClass:"bd"},[s("el-pagination",{attrs:{background:"","current-page":e.userCollectionUserListPageNum,"page-sizes":[10,20,30],"page-size":e.userCollectionUserListPageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.userCollectionUserListTotalItems},on:{"size-change":e.onUserCollectionUserListPageSizeChange,"current-change":e.onUserCollectionUserListPageChange}})],1)],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("保存")]),e._v(" "),s("el-button",{on:{click:function(t){return e.$router.back(-1)}}},[e._v("取消")])],1),e._v(" "),s("el-dialog",{attrs:{title:"选择用户添加到用户组",visible:e.addFromUserListDialogVisible,width:"80%"},on:{"update:visible":function(t){e.addFromUserListDialogVisible=t}}},[s("el-table",{ref:"userListTable",staticStyle:{width:"100%"},attrs:{data:e.userListTableData,"tooltip-effect":"dark"},on:{select:e.onUserListSelect,"select-all":e.onUserListSelectAll}},[s("el-table-column",{attrs:{type:"selection",align:"center",width:"50"}}),e._v(" "),s("el-table-column",{attrs:{prop:"id",label:"用户ID",align:"center",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"username",label:"用户名",align:"center","min-width":"3","show-overflow-tooltip":!0}}),e._v(" "),s("el-table-column",{attrs:{prop:"studentNo",label:"学号","min-width":"3",align:"center"}})],1),e._v(" "),s("div",{staticClass:"bd"},[s("el-pagination",{attrs:{background:"","current-page":e.userListPageNum,"page-sizes":[10,20,30],"page-size":e.userListPageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.userListTotalItems},on:{"size-change":e.onUserListPageSizeChange,"current-change":e.onUserListPageChange}})],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.selectedUserIds&&0!==e.selectedUserIds.length?[s("p",[e._v("将新增 "),s("strong",[e._v(e._s(e.selectedUserIds.length))]),e._v(" 个用户到用户组中")])]:e._e(),e._v(" "),e.selectedUserIds&&0!==e.selectedUserIds.length?s("el-button",{attrs:{type:"warning"},on:{click:e.resetSelectedUserIds}},[e._v("重 置")]):e._e(),e._v(" "),s("el-button",{attrs:{type:"danger"},on:{click:function(t){e.addFromUserListDialogVisible=!1}}},[e._v("关 闭")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.onAddUser}},[e._v("确 定")])],2)],1)],1)],1)},n=[],i=(s("7f7f"),s("b85c")),o=(s("96cf"),s("1da1")),a=(s("ac6a"),s("fa8d")),l=s("b775"),c=s("6793");function u(e,t,s,r){var n={pageNum:e,pageSize:t};return s&&r&&(n[s]=r),Object(l["a"])({url:"".concat(c["a"].userCollectionBase,"/"),method:"get",params:n})}function d(e){return Object(l["a"])({url:"".concat(c["a"].userCollectionUserIds,"/").concat(e),method:"get"})}function f(e,t){return Object(l["a"])({url:"".concat(c["a"].userCollectionBulk,"/").concat(e),method:"post",data:t})}function h(e){return Object(l["a"])({url:c["a"].userCollectionBulk,method:"delete",data:e})}var g=s("c24f"),p={data:function(){return{checkRules:{name:[{required:!0,message:"用户组名称不能为空",trigger:"blur"}]},userGroupDetail:{name:""},userListTableData:[],userListTotalItems:0,userListPageSize:10,userListPageNum:1,userListIsLoading:!1,collectionUserIds:[],selectedUserIds:[],addFromUserListDialogVisible:!1,userCollectionUserListSelection:[],userCollectionUserListPageNum:1,userCollectionUserListPageSize:20,userCollectionUserListTotalItems:0,userCollectionUserListTableData:[]}},computed:{userGroupId:function(){return this.$route.params.id}},mounted:function(){this.getUserGroupDetail(this.userGroupId),this.getUserCollectionUserList(this.userGroupId)},methods:{onUserCollectionUserListSelect:function(e,t){var s=this,r=e.length&&-1!==e.indexOf(t);if(r)e.forEach((function(e){-1===s.userCollectionUserListSelection.indexOf(e.id)&&s.userCollectionUserListSelection.push(e.id)}));else{var n=this.userCollectionUserListSelection.indexOf(t.id);-1!==n&&this.userCollectionUserListSelection.splice(n,1)}},onUserCollectionUserListSelectAll:function(e){var t=this;e.length>0?e.forEach((function(e){-1===t.userCollectionUserListSelection.indexOf(e.id)&&t.userCollectionUserListSelection.push(e.id)})):this.userCollectionUserListTableData.forEach((function(e){var s=t.userCollectionUserListSelection.indexOf(e.id);-1!==s&&t.selectedUserIds.splice(s,1)}))},getUserIdsByUserGroupId:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.handleResponse(d(t),"获取用户组包含的全部用户ID",(function(e){s.collectionUserIds=e.data}));case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),onUserListSelectAll:function(e){var t=this;e.length>0?e.forEach((function(e){-1===t.collectionUserIds.indexOf(e.id)&&-1===t.selectedUserIds.indexOf(e.id)&&t.selectedUserIds.push(e.id)})):this.userListTableData.forEach((function(e){if(-1===t.collectionUserIds.indexOf(e.id)){var s=t.selectedUserIds.indexOf(e.id);-1!==s&&t.selectedUserIds.splice(s,1)}else t.$refs.userListTable.toggleRowSelection(e,!0)}))},onUserListSelect:function(e,t){var s=this,r=e.length&&-1!==e.indexOf(t);if(r)e.forEach((function(e){-1===s.collectionUserIds.indexOf(e.id)&&-1===s.selectedUserIds.indexOf(e.id)&&s.selectedUserIds.push(e.id)}));else{var n=this.selectedUserIds.indexOf(t.id);-1!==n&&this.selectedUserIds.splice(n,1)}},onUserListPageSizeChange:function(e){this.userListPageSize=e,this.refreshUserList()},onUserListPageChange:function(e){this.userListPageNum=e,this.refreshUserList()},resetSelectedUserIds:function(){this.selectedUserIds.length=0,this.refreshUserList()},onAddUser:function(){var e=this;this.selectedUserIds&&0!==this.selectedUserIds.length?this.handleResponse(f(this.userGroupId,this.selectedUserIds),"添加用户",(function(t){if(t.data.success&&0===t.data.success.length)e.$message.error("添加用户失败，请稍后再试");else if((t.data.fail&&t.data.fail.length)>0||(t.data.duplicated&&t.data.duplicated.length)>0){var s="成功执行添加操作";t.data.fail.length>0&&(s+="，部分用户添加失败："+t.data.fail),t.data.duplicated.length>0&&(s+="，部分用户已存在于用户组中："+t.data.duplicated),e.$message({message:s,type:"warning"})}else e.$message.success("添加用户成功");e.addFromUserListDialogVisible=!1,e.selectedUserIds.length=0,e.getUserCollectionUserList(e.userGroupId)})):this.$message.error("请选择要添加到用户组的用户")},getUserList:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.userListIsLoading=!0,e.next=3,this.handleResponse(Object(g["f"])(this.userListPageNum,this.userListPageSize),"获取用户列表",(function(e){t.userListTableData=e.data.records,t.userListTotalItems=e.data.total}),null,null,(function(){t.userListIsLoading=!1}));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),refreshUserList:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getUserList();case 2:t=Object(i["a"])(this.userListTableData);try{for(t.s();!(s=t.n()).done;)r=s.value,-1===this.collectionUserIds.indexOf(r.id)&&-1===this.selectedUserIds.indexOf(r.id)||this.$refs.userListTable.toggleRowSelection(r,!0)}catch(n){t.e(n)}finally{t.f()}case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),openAddFromUserListDialog:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.addFromUserListDialogVisible=!0,e.next=3,this.getUserIdsByUserGroupId(this.userGroupId);case 3:return e.next=5,this.refreshUserList();case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onDeleteUserCollectionSelection:function(){var e=this;this.$confirm("是否从用户组中移除所选的".concat(this.userCollectionUserListSelection?this.userCollectionUserListSelection.length+"个":"","用户?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.userCollectionUserListSelection&&e.userCollectionUserListSelection.length>0?e.handleResponse(h(e.userCollectionUserListSelection),"从用户组中移除选中的用户",(function(t){t.data.success&&0===t.data.success.length?e.$message.error("从用户组中移除选中的用户失败，请稍后再试"):t.data.fail&&t.data.fail.length>0?(e.userCollectionUserListSelection.length=0,e.userCollectionUserListPageNum=1,e.$message({message:"成功执行移除操作，但部分用户移除失败："+t.data.fail,type:"warning"})):(e.userCollectionUserListSelection.length=0,e.userCollectionUserListPageNum=1,e.$message.success("成功从用户组中移除选中的用户")),e.getUserCollectionUserList(e.userGroupId)})):e.$message.error("请检查是否选择了要移除的用户")}))},onUserCollectionUserListPageChange:function(e){this.userCollectionUserListPageNum=e,this.getUserCollectionUserList(this.userGroupId)},onUserCollectionUserListPageSizeChange:function(e){this.userCollectionUserListPageSize=e,this.getUserCollectionUserList(this.userGroupId)},getUserCollectionUserList:function(e){var t=this;this.handleResponse(u(this.userCollectionUserListPageNum,this.userCollectionUserListPageSize,"userGroupId",e),"获取用户组的用户列表",(function(e){t.userCollectionUserListTableData=e.data.records,t.userCollectionUserListTotalItems=e.data.total}),null,null,(function(){t.userCollectionUserListTableData.forEach((function(e){-1!==t.userCollectionUserListSelection.indexOf(e.id)&&t.$refs.userCollectionUserListTable.toggleRowSelection(e,!0)}))}))},onSubmit:function(){var e=this;this.$refs.userGroupDetail.validate((function(t){t?e.handleResponse(Object(a["f"])(e.userGroupId,e.userGroupDetail.name.trim()),"更新用户组",(function(t){e.$message.success("更新用户组成功"),e.$router.back(-1)})):e.$message.error("请确认所有项目均填写正确！")}))},getUserGroupDetail:function(e){var t=this;this.handleResponse(Object(a["d"])(e),"获取用户组详情",(function(e){t.userGroupDetail=e.data}))}}},U=p,m=(s("7512"),s("2877")),L=Object(m["a"])(U,r,n,!1,null,"60c9e5a4",null);t["default"]=L.exports},fa8d:function(e,t,s){"use strict";s.d(t,"c",(function(){return i})),s.d(t,"e",(function(){return o})),s.d(t,"a",(function(){return a})),s.d(t,"f",(function(){return l})),s.d(t,"d",(function(){return c})),s.d(t,"b",(function(){return u}));var r=s("b775"),n=s("6793");function i(){return Object(r["a"])({url:n["a"].userGroupCount,method:"get"})}function o(e,t,s,i){var o={pageNum:e,pageSize:t};return s&&i&&(o[s]=i),Object(r["a"])({url:"".concat(n["a"].userGroupBase,"/"),method:"get",params:o})}function a(e){return Object(r["a"])({url:"".concat(n["a"].userGroupBase,"/"),method:"post",data:{name:e}})}function l(e,t){return Object(r["a"])({url:"".concat(n["a"].userGroupBase,"/").concat(e),method:"put",data:{name:t}})}function c(e){return Object(r["a"])({url:"".concat(n["a"].userGroupBase,"/").concat(e),method:"get"})}function u(e){return Object(r["a"])({url:"".concat(n["a"].userGroupBase,"/").concat(e),method:"delete"})}}}]);