(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-89114ea8"],{"367d":function(e,t,n){},"456d":function(e,t,n){var s=n("4bf8"),i=n("0d58");n("5eda")("keys",(function(){return function(e){return i(s(e))}}))},"5eda":function(e,t,n){var s=n("5ca1"),i=n("8378"),a=n("79e5");e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],r={};r[e]=t(n),s(s.S+s.F*a((function(){n(1)})),"Object",r)}},"7fd8":function(e,t,n){e.exports=n.p+"static/img/create_users_in_bulk_hint.c40e04a2.png"},aef6:function(e,t,n){"use strict";var s=n("5ca1"),i=n("9def"),a=n("d2c8"),r="endsWith",o=""[r];s(s.P+s.F*n("5147")(r),"String",{endsWith:function(e){var t=a(this,e,r),n=arguments.length>1?arguments[1]:void 0,s=i(t.length),l=void 0===n?s:Math.min(i(n),s),c=String(e);return o?o.call(t,c,l):t.slice(l-c.length,l)===c}})},b85c:function(e,t,n){"use strict";function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function i(e,t){if(e){if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function a(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=i(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var s=0,a=function(){};return{s:a,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,r=e},f:function(){try{o||null==n["return"]||n["return"]()}finally{if(l)throw r}}}}n.d(t,"a",(function(){return a}))},db9f:function(e,t,n){"use strict";n("367d")},e382:function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container"},[s("div",{staticClass:"operation-button"},[s("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{"prefix-icon":"el-icon-search",placeholder:"请输入搜索关键字"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch(t)}},model:{value:e.searchKeyword,callback:function(t){e.searchKeyword=t},expression:"searchKeyword"}}),e._v(" "),s("el-select",{model:{value:e.searchType,callback:function(t){e.searchType=t},expression:"searchType"}},e._l(e.searchTypeList,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.onSearch}},[s("svg-icon",{attrs:{"icon-class":"search"}}),e._v(" 搜索\n    ")],1),e._v(" "),e.inSearch?s("el-button",{attrs:{type:"primary"},on:{click:e.onCancelSearch}},[s("i",{staticClass:"el-icon-close"}),e._v(" 取消搜索\n    ")]):e._e(),e._v(" "),s("el-button",{attrs:{type:"danger"},on:{click:e.onNewUser}},[s("i",{staticClass:"el-icon-plus"}),e._v(" 新建用户\n    ")]),e._v(" "),s("el-button",{attrs:{type:"warning"},on:{click:function(t){e.newUserBatchDialogVisible=!0}}},[s("i",{staticClass:"el-icon-plus"}),e._v(" 批量新建用户\n    ")]),e._v(" "),s("el-dialog",{attrs:{title:"批量新建用户",visible:e.newUserBatchDialogVisible,width:"60%"},on:{"update:visible":function(t){e.newUserBatchDialogVisible=t}}},[s("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"根据学号批量新建",name:"addByStudentNo"}},[s("el-form",{ref:"newUserBatchByStudentNoData",attrs:{model:e.newUserBatchByStudentNoData,rules:e.checkRules.addByStudentNoForm}},[s("el-form-item",{attrs:{label:"起始学号",prop:"start"}},[s("el-input",{attrs:{type:"number",placeholder:"请输入起始学号"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onNewUserBatch(t)}},model:{value:e.newUserBatchByStudentNoData.start,callback:function(t){e.$set(e.newUserBatchByStudentNoData,"start",t)},expression:"newUserBatchByStudentNoData.start"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"终止学号",prop:"end"}},[s("el-input",{attrs:{type:"number",placeholder:"请输入终止学号"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onNewUserBatch(t)}},model:{value:e.newUserBatchByStudentNoData.end,callback:function(t){e.$set(e.newUserBatchByStudentNoData,"end",t)},expression:"newUserBatchByStudentNoData.end"}})],1)],1)],1),e._v(" "),s("el-tab-pane",{attrs:{label:"从Excel文件中导入",name:"addFromExcel"}},[s("p",[s("strong",[s("h3",[e._v("Excel中的数据需要严格按照下图中的要求：")])])]),e._v(" "),s("img",{attrs:{id:"hint-image",src:n("7fd8"),alt:"import_excel_description"}}),e._v(" "),s("el-form",[s("form",{attrs:{enctype:"multipart/form-data"}},[s("el-form-item",{attrs:{label:"选择要导入的Excel"}},[s("input",{staticClass:"el-button",attrs:{id:"excel-file",type:"file",name:"files[]"},on:{change:e.onExcelFileChange}})])],1)])],1)],1),e._v(" "),s("br"),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("strong",[e._v("默认密码为用户学号")]),e._v(" "),s("el-button",{on:{click:function(t){e.newUserBatchDialogVisible=!1}}},[e._v("取消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.onNewUserBatch}},[e._v("确定")])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"批量添加用户确认",visible:e.newUserBatchConfirmDialogVisible,width:"70%"},on:{"update:visible":function(t){e.newUserBatchConfirmDialogVisible=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"确认添加以下用户："}},[s("el-input",{attrs:{type:"textarea",disabled:!0,autosize:{minRows:8,maxRows:8}},model:{value:e.newStudentNoListStr,callback:function(t){e.newStudentNoListStr=t},expression:"newStudentNoListStr"}})],1),e._v(" "),s("p",[e._v("\n          将会添加\n          "),s("strong",[e._v(e._s(e.newStudentNoListCount))]),e._v(" 个用户\n        ")])],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.newUserBatchConfirmDialogVisible=!1}}},[e._v("取消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.onNewUserBatchConfirmed}},[e._v("确定添加")])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"正在批量添加用户",visible:e.newUserBatchProgressDialogVisible,width:"60%"},on:{"update:visible":function(t){e.newUserBatchProgressDialogVisible=t}}},[s("el-row",[s("el-col",{attrs:{span:12}},[s("p",{staticClass:"center"},[s("strong",[e._v("未添加用户")])]),e._v(" "),s("select",{staticClass:"newStudentList",attrs:{multiple:"multiple",size:"8"}},e._l(e.newStudentNoList,(function(t){return s("option",[e._v(e._s(t.studentNo+"-"+t.username))])})),0)]),e._v(" "),s("el-col",{attrs:{span:12}},[s("p",{staticClass:"center"},[s("strong",[e._v("已添加用户")])]),e._v(" "),s("select",{staticClass:"newStudentList",attrs:{multiple:"multiple",size:"8"}},e._l(e.studentNoAddedList,(function(t){return s("option",[e._v(e._s(t))])})),0)])],1),e._v(" "),s("p",[s("strong",[e._v("请等待新用户批量添加完成之后再关闭该窗口！")])]),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.closeNewUserBatchProgressDialog}},[e._v("关闭")])],1)],1)],1),e._v(" "),[s("v-table",{staticStyle:{width:"100%"},attrs:{width:1e3,"is-horizontal-resize":"","is-loading":e.isLoading,columns:e.tableConfig.columns,"table-data":e.tableConfig.tableData,"multiple-sort":!1,"row-hover-color":"#eee","row-click-color":"#edf7ff"},on:{"sort-change":e.sortChange,"on-custom-comp":e.onTableOperation}})],e._v(" "),[s("div",{staticClass:"bd"},[s("v-pagination",{attrs:{"show-paging-count":3,total:e.totalItems,"page-size":e.pageSize,layout:["total","sizer","prev","pager","next","jumper"]},on:{"page-change":e.pageChange,"page-size-change":e.pageSizeChange}})],1)]],2)},i=[],a=(n("7f7f"),n("aef6"),n("c5f6"),n("96cf"),n("1da1")),r=(n("456d"),n("b85c")),o=(n("ac6a"),n("34bf"),n("e5fb")),l=n("c24f"),c=(n("6793"),{components:{VTable:o["VTable"],VPagination:o["VPagination"]},data:function(){return{orderByStudentNo:"",newStudentNoListCount:0,newStudentNoListStr:"",newStudentNoList:[],studentNoAddedList:[],currentAddProgress:0,flag:0,checkRules:{addByStudentNoForm:{start:[{required:!0,message:"起始学号不能为空",trigger:"blur"}],end:[{required:!0,message:"终止学号不能为空",trigger:"blur"}]}},searchTypeList:[{label:"用户ID",value:"id"},{label:"用户名",value:"username"},{label:"邮箱",value:"email"},{label:"学号",value:"studentNo"}],selectedFile:"",newUserBatchByStudentNoData:{start:"",end:""},activeName:"addByStudentNo",newUserBatchDialogVisible:!1,newUserBatchConfirmDialogVisible:!1,newUserBatchProgressDialogVisible:!1,searchType:"id",inSearch:!1,searchKeyword:"",pageNum:1,pageSize:20,totalItems:0,isLoading:!1,tableConfig:{tableData:[],columns:[{field:"id",title:"用户ID",width:100,titleAlign:"center",columnAlign:"center",isResize:!0,formatter:function(e,t,n,s){return'<a href="#/user/edit/'.concat(e.id,'">').concat(e.id,"</a>")}},{field:"username",title:"用户名",width:200,titleAlign:"center",columnAlign:"center",isResize:!0,formatter:function(e,t,n,s){return'<a href="#/user/edit/'.concat(e.id,'" title="').concat(e.username,'">').concat(e.username,"</a>")}},{field:"studentNo",title:"学号",width:200,titleAlign:"center",columnAlign:"center",isResize:!0,orderBy:""},{field:"email",title:"邮箱",width:100,titleAlign:"center",columnAlign:"center",isResize:!0},{field:"status",title:"用户状态",width:100,titleAlign:"center",columnAlign:"center",isResize:!0},{field:"action",title:"操作",width:300,titleAlign:"center",columnAlign:"center",isResize:!0,componentName:"user-operation-button-with-solution"}]}}},created:function(){},mounted:function(){this.getUserList()},methods:{onChangeTableStatus:function(){this.inSearch?this.onSearch():this.getUserList()},sortChange:function(e){this.orderByStudentNo=e.studentNo,this.onChangeTableStatus()},parseExcel:function(e){var t=this,n=!0,s=new FileReader;s.onload=function(e){var s=e.target.result,i=XLSX.read(s,{type:"binary"});i.SheetNames.forEach((function(e){var s,a=e,o=XLSX.utils.sheet_to_row_object_array(i.Sheets[e]),l=JSON.stringify(o),c=JSON.parse(l),u=Object(r["a"])(c);try{var d=function(){var e=s.value;if(Object.keys(e).map((function(t){return e[t.trim()]="string"===typeof e[t]?e[t].trim():e[t]})),!n||!e.hasOwnProperty("学号"))return n=!1,"break";var i={};i.className=a,e.hasOwnProperty("姓名")?(i.username=e["姓名"],i.studentNo=e["学号"]):(i.username=e["学号"],i.studentNo=e["学号"]),t.newStudentNoList.push(i)};for(u.s();!(s=u.n()).done;){var h=d();if("break"===h)break}}catch(f){u.e(f)}finally{u.f()}})),n?(t.refreshStudentNoListStr(),t.newUserBatchConfirmDialogVisible=!0,t.newUserBatchDialogVisible=!1):t.$message.error("请检查 Excel 文件格式是否正确！")},s.onerror=function(e){console.log(e)},s.readAsBinaryString(e)},closeNewUserBatchProgressDialog:function(){this.newUserBatchProgressDialogVisible=!1,this.getUserList()},isEmpty:function(e){return"undefined"===typeof e||null==e||""===e},onExcelFileChange:function(e){this.selectedFile=e.target.files[0]},onSearch:function(){var e=this,t=this.searchKeyword.trim();this.pageNum=1,0===t.length?this.$message.error("请输入关键字！"):(this.isLoading=!0,this.handleResponse(Object(l["f"])(this.pageNum,this.pageSize,this.orderByStudentNo,this.searchType,t),"搜索用户",(function(t){e.tableConfig.tableData=t.data.records,e.totalItems=t.data.total,e.inSearch=!0}),null,null,(function(){e.isLoading=!1})))},onNewUserBatchConfirmed:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.newUserBatchConfirmDialogVisible=!1,this.newUserBatchProgressDialogVisible=!0,this.flag=0;case 3:if(!(this.flag<this.newStudentNoList.length)){e.next=10;break}return console.log("列表"+this.newStudentNoList[this.flag].username),e.next=7,this.addUserInBulk(this.newStudentNoList[this.flag]);case 7:this.flag++,e.next=3;break;case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onCancelSearch:function(){this.inSearch=!1,this.getUserList()},refreshStudentNoListStr:function(){if(this.newStudentNoList){this.newStudentNoListCount=this.newStudentNoList.length,this.newStudentNoListStr="";var e,t=Object(r["a"])(this.newStudentNoList);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.studentNo===n.username?this.newStudentNoListStr+=n.studentNo+"\n":this.newStudentNoListStr+=n.studentNo+" - "+n.username+"\n"}}catch(s){t.e(s)}finally{t.f()}}},addUserInBulk:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.handleResponse(Object(l["g"])(t.username,t.studentNo,t.studentNo+"@ncu.edu.cn",t.studentNo,t.className),"导入用户",(function(e){if(console.log(e.message),"false"!==e.message)for(var s=0;s<n.newStudentNoList.length;s++)if(n.newStudentNoList[s].studentNo===e.message){n.newStudentNoList.splice(s,1),n.studentNoAddedList.push(t.studentNo+" "+t.username),n.flag--;break}n.currentAddProgress+=1,n.currentAddProgress===n.newStudentNoListCount&&(0===n.newStudentNoList.length?n.$message({message:"批量添加用户操作完成，全部用户均添加成功！",type:"success"}):n.$message.error("批量添加用户操作完成，部分用户添加失败！"))})).catch((function(e){console.log(e)}));case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),onNewUserBatch:function(){switch(this.newStudentNoList.length=0,this.studentNoAddedList.length=0,this.currentAddProgress=0,this.activeName){case"addByStudentNo":if(this.isEmpty(this.newUserBatchByStudentNoData.start)||this.isEmpty(this.newUserBatchByStudentNoData.end))this.$message.error("请检查起始学号与终止学号是否输入完整！");else{var e=Number(this.newUserBatchByStudentNoData.start),t=Number(this.newUserBatchByStudentNoData.end);if(e>t)this.$message.error("起始学号不能大于终止学号！");else{for(var n=e;n<=t;n++)this.newStudentNoList.push({username:n,studentNo:n});this.refreshStudentNoListStr(),this.newUserBatchConfirmDialogVisible=!0,this.newUserBatchDialogVisible=!1}}break;case"addFromExcel":null==this.selectedFile||""===this.selectedFile||!this.selectedFile.name.endsWith("xls")&&!this.selectedFile.name.endsWith("xlsx")?this.$message.error("请正确选择Excel文件！"):this.parseExcel(this.selectedFile);break;default:break}},onNewUser:function(){this.$router.push({path:"/user/add/"})},onTableOperation:function(e){var t=this,n=e.index,s=this.tableConfig.tableData[n].id;if("delete"===e.type){var i="您确定要锁定该用户吗？",a="锁定";"正常"!==this.tableConfig.tableData[n].status&&(i="您确定要解锁该用户吗？",a="解锁"),this.$confirm(i,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.handleResponse(Object(l["b"])(s),(function(e){t.$message.success("".concat(a,"用户成功")),t.getUserList()}))}))}else"edit"===e.type?this.$router.push({path:"/user/edit/"+s}):"showSolution"===e.type&&this.$router.push({path:"/solution/user/"+s})},pageChange:function(e){this.pageNum=e,this.onChangeTableStatus()},pageSizeChange:function(e){this.pageSize=e,this.onChangeTableStatus()},getUserList:function(){var e=this;this.isLoading=!0,this.handleResponse(Object(l["f"])(this.pageNum,this.pageSize,this.orderByStudentNo),"获取用户列表",(function(t){e.tableConfig.tableData=t.data.records,e.totalItems=t.data.total}),null,null,(function(){e.isLoading=!1}))}}}),u=c,d=(n("db9f"),n("2877")),h=Object(d["a"])(u,s,i,!1,null,"f26221d2",null);t["default"]=h.exports}}]);