(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0df11465"],{"323a":function(e,t,a){},4136:function(e,t,a){"use strict";a("323a")},5147:function(e,t,a){var i=a("2b4c")("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(a){try{return t[i]=!1,!"/./"[e](t)}catch(n){}}return!0}},"8c96":function(e,t,a){e.exports=a.p+"static/img/import_excel_description.9e5edd10.png"},aae3:function(e,t,a){var i=a("d3f4"),n=a("2d95"),r=a("2b4c")("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[r])?!!t:"RegExp"==n(e))}},aef6:function(e,t,a){"use strict";var i=a("5ca1"),n=a("9def"),r=a("d2c8"),s="endsWith",o=""[s];i(i.P+i.F*a("5147")(s),"String",{endsWith:function(e){var t=r(this,e,s),a=arguments.length>1?arguments[1]:void 0,i=n(t.length),c=void 0===a?i:Math.min(n(a),i),l=String(e);return o?o.call(t,l,c):t.slice(c-l.length,c)===l}})},c48b:function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"f",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return c})),a.d(t,"g",(function(){return l})),a.d(t,"e",(function(){return u})),a.d(t,"b",(function(){return d}));var i=a("b775"),n=a("6793");function r(){return Object(i["a"])({url:n["a"].databaseCount,method:"get"})}function s(e,t,a,r){var s={pageNum:e,pageSize:t};return a&&r&&(s[a]=r),Object(i["a"])({url:"".concat(n["a"].databaseBase,"/"),method:"get",params:s})}function o(){return Object(i["a"])({url:n["a"].getAllDatabase,method:"get"})}function c(e,t,a){return Object(i["a"])({url:"".concat(n["a"].databaseBase,"/"),method:"post",data:{name:e,createTable:t,testData:a}})}function l(e,t,a,r){return Object(i["a"])({url:"".concat(n["a"].databaseBase,"/").concat(e),method:"put",data:{name:t,createTable:a,testData:r}})}function u(e){return Object(i["a"])({url:"".concat(n["a"].databaseBase,"/").concat(e),method:"get"})}function d(e){return Object(i["a"])({url:"".concat(n["a"].databaseBase,"/").concat(e),method:"delete"})}},d1d1:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("el-form",{ref:"databaseDetail",attrs:{model:e.databaseDetail,rules:e.checkRules,"label-width":"120px"}},[e.isAdd?e._e():i("el-form-item",{attrs:{label:"数据库ID"}},[i("el-input",{attrs:{disabled:""},model:{value:e.databaseDetail.id,callback:function(t){e.$set(e.databaseDetail,"id",t)},expression:"databaseDetail.id"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"数据库名称",prop:"name"}},[i("el-input",{model:{value:e.databaseDetail.name,callback:function(t){e.$set(e.databaseDetail,"name",t)},expression:"databaseDetail.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"建表语句",prop:"createTable"}},[i("codemirror",{attrs:{options:e.cmOptions},on:{ready:e.onCmReady},model:{value:e.databaseDetail.createTable,callback:function(t){e.$set(e.databaseDetail,"createTable",t)},expression:"databaseDetail.createTable"}}),e._v(" "),e._e()],1),e._v(" "),i("el-dialog",{attrs:{title:"从Excel导入测试数据",visible:e.importFromExcelDialogVisible,width:"60%"},on:{"update:visible":function(t){e.importFromExcelDialogVisible=t}}},[i("el-form",[i("h3",[e._v("Excel中的数据需要严格按照下图中的要求：")]),e._v(" "),i("img",{attrs:{id:"hint-image",src:a("8c96"),alt:"import_excel_description"}}),e._v(" "),i("form",{attrs:{enctype:"multipart/form-data"}},[i("el-form-item",{attrs:{label:"选择要导入的Excel"}},[i("input",{staticClass:"el-button",attrs:{id:"excel-file",type:"file",name:"files[]"},on:{change:e.onExcelFileChange}})])],1)]),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.importFromExcelDialogVisible=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.importFromExcel()}}},[e._v("确定导入")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"测试数据",prop:"testData"}},[i("p",[i("el-button",{on:{click:function(t){e.importFromExcelDialogVisible=!0}}},[e._v("从Excel导入测试数据")])],1),e._v(" "),i("codemirror",{attrs:{options:e.cmOptions},on:{ready:e.onCmReady},model:{value:e.databaseDetail.testData,callback:function(t){e.$set(e.databaseDetail,"testData",t)},expression:"databaseDetail.testData"}}),e._v(" "),e._e()],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("保存")]),e._v(" "),i("el-button",{on:{click:e.onCancel}},[e._v("取消")])],1)],1)],1)},n=[],r=(a("7f7f"),a("aef6"),a("ac6a"),a("8f94")),s=(a("a7be"),a("ffda"),a("8c06"),a("9b74"),a("991c"),a("8c33"),a("f6b6"),a("c48b")),o={components:{codemirror:r["codemirror"]},data:function(){return{selectedFile:"",importFromExcelDialogVisible:!1,cmOptions:{tabSize:4,mode:"text/x-mysql",theme:"solarized light",lineNumbers:!0,styleActiveLine:!0,lineWrapping:!0,indentWithTabs:!0,hintOptions:{completeSingle:!1},line:!0},checkRules:{name:[{required:!0,message:"数据库名称不能为空",trigger:"blur"}],createTable:[{required:!0,message:"建表语句不能为空",trigger:"blur"}],testData:[{required:!0,message:"测试数据不能为空",trigger:"blur"}]},databaseDetail:{id:"",name:"",createTable:"",testData:""}}},computed:{codemirror:function(){return this.$refs.myCm.codemirror},isAdd:function(){return void 0===this.$route.params.id}},mounted:function(){var e=this.$route.params.id;this.isAdd||this.getDatabaseDetail(e)},methods:{parseExcel:function(e){var t=this,a=new FileReader;a.onload=function(e){var a=e.target.result,i=XLSX.read(a,{type:"binary"});t.databaseDetail.testData="",i.SheetNames.forEach((function(e){var a=XLSX.utils.sheet_to_row_object_array(i.Sheets[e]),n=JSON.stringify(a),r=JSON.parse(n);for(var s in r){var o=r[s],c=[],l=[];for(var u in o)c.push(u),l.push(o[u]);var d=t.constructSQLExpression(e,c,l);t.databaseDetail.testData+=d+"\n"}}))},a.onerror=function(e){console.log(e)},a.readAsBinaryString(e)},onExcelFileChange:function(e){this.selectedFile=e.target.files[0]},importFromExcel:function(){null==this.selectedFile||""===this.selectedFile||!this.selectedFile.name.endsWith("xls")&&!this.selectedFile.name.endsWith("xlsx")?this.$message.error("请正确选择Excel文件！"):this.parseExcel(this.selectedFile),this.importFromExcelDialogVisible=!1},onCmReady:function(e){e.on("keypress",(function(){e.showHint()}))},onSubmit:function(){var e=this;this.$refs.databaseDetail.validate((function(t){if(t){var a={name:e.databaseDetail.name.trim(),createTable:e.databaseDetail.createTable.trim(),testData:e.databaseDetail.testData.trim()};e.isAdd?e.handleResponse(Object(s["a"])(a.name,a.createTable,a.testData),"添加数据库",(function(t){e.$message.success("添加数据库成功"),e.$router.back(-1)})):e.handleResponse(Object(s["g"])(e.$route.params.id,a.name,a.createTable,a.testData),"更新数据库",(function(t){e.$message.success("更新数据库成功"),e.$router.back(-1)}))}else e.$message.error("请确认所有项目均填写正确！")}))},onCancel:function(){this.$router.back(-1)},getDatabaseDetail:function(e){var t=this;this.handleResponse(Object(s["e"])(e),"获取数据库详情",(function(e){t.databaseDetail=e.data}))}}},c=o,l=(a("4136"),a("2877")),u=Object(l["a"])(c,i,n,!1,null,"1f584fd8",null);t["default"]=u.exports},d2c8:function(e,t,a){var i=a("aae3"),n=a("be13");e.exports=function(e,t,a){if(i(t))throw TypeError("String#"+a+" doesn't accept regex!");return String(n(e))}}}]);